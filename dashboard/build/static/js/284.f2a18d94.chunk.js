"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[284],{284:(e,n,t)=>{t.r(n),t.d(n,{default:()=>S});var i,a,s,r,o,l,d,c,u=t(9379),h=t(7528),m=t(5043),p=t(8223),f=t(2045),y=t(8845),g=t(1924),x=t(3411),b=t(1146),w=t(5464),j=t(579);const A=w.Ay.button(i||(i=(0,h.A)(["\n  background: ",";\n  color: #212121;\n  font-size: 17px;\n  font-weight: 700;\n  padding: 12px 28px;\n  border-radius: 14px;\n  box-shadow: 0 2px 10px rgba(255,193,7,0.10);\n  border: none;\n  margin-left: 0;\n  display: flex;\n  align-items: center;\n  gap: 10px;\n  cursor: pointer;\n  transition: background 0.18s, box-shadow 0.18s, transform 0.18s, opacity 0.18s;\n  opacity: 0.97;\n  will-change: transform, opacity;\n  &:hover {\n    background: ",";\n    color: #fff;\n    transform: scale(1.045);\n    opacity: 1;\n    box-shadow: 0 8px 32px rgba(76,175,80,0.16);\n  }\n  @media (max-width: 700px) {\n    width: 100%;\n    margin-top: 10px;\n    justify-content: center;\n    font-size: 16px;\n    padding: 12px 0;\n  }\n"])),e=>{let{theme:n}=e;return n.colors.accent},e=>{let{theme:n}=e;return n.colors.primary}),E=(w.Ay.h2(a||(a=(0,h.A)(["\n  font-size: 1.5em;\n  font-weight: 700;\n  color: ",";\n  margin: 32px 0 12px 0;\n"])),e=>{let{theme:n}=e;return n.colors.primary}),w.Ay.div(s||(s=(0,h.A)(["\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding-bottom: 10px;\n  margin-bottom: 18px;\n  border-bottom: 1.5px solid ",";\n"])),e=>{let{theme:n}=e;return n.colors.border}),w.Ay.div(r||(r=(0,h.A)(["\n  display: flex;\n  align-items: center;\n  gap: 18px;\n  width: 100%;\n"]))),w.Ay.div(o||(o=(0,h.A)(["\n  display: flex;\n  justify-content: flex-end;\n  gap: 12px;\n  margin-top: 18px;\n"]))),(0,w.Ay)(x.A)(l||(l=(0,h.A)(["\n  margin-right: 10px;\n"])))),S=(w.Ay.div(d||(d=(0,h.A)(["\n  color: ",";\n  font-size: 1.1em;\n  margin-bottom: 18px;\n"])),e=>{let{theme:n}=e;return n.colors.textSecondary}),w.Ay.div(c||(c=(0,h.A)(["\n  background: ",";\n  border-radius: 14px;\n  padding: 18px 0 0 0;\n"])),e=>{let{theme:n}=e;return n.colors.background}),()=>{const{benutzer:e}=(0,p.J)(),[n,t]=(0,m.useState)([]),[i,a]=(0,m.useState)(!0),[s,r]=(0,m.useState)(null),[o,l]=(0,m.useState)(""),[d,c]=(0,m.useState)(!1),[h,x]=(0,m.useState)({name:"",email:"",password:"",institutionId:""}),[w,S]=(0,m.useState)(null),[v,C]=(0,m.useState)(0),[k,I]=(0,m.useState)(10),[F,T]=(0,m.useState)([]),[z,P]=(0,m.useState)(!0),[N,D]=(0,m.useState)(null),[B,L]=(0,m.useState)(""),[O,J]=(0,m.useState)(!1),[U,M]=(0,m.useState)({name:"",address:""}),[R,q]=(0,m.useState)(null),[H,V]=(0,m.useState)(0),[W,_]=(0,m.useState)(10),Q=async()=>{a(!0),r(null);try{const e=(await(0,f.gv)()).map(e=>{const n=F.find(n=>n.id===e.institutionId);return(0,u.A)((0,u.A)({},e),{},{institutionName:n?n.name:""})});t(e)}catch(e){r(e.message||"Fehler beim Laden der Admins.")}a(!1)},Z=async()=>{P(!0),D(null);try{const e=await(0,f.yS)();T(e)}catch(e){D(e.message||"Fehler beim Laden der Institutionen.")}P(!1)};(0,m.useEffect)(()=>{"SUPER_ADMIN"===(null===e||void 0===e?void 0:e.role)&&(Q(),Z())},[e]);if("SUPER_ADMIN"!==(null===e||void 0===e?void 0:e.role))return(0,j.jsx)(y.IW,{children:"Zugriff verweigert"});return(0,j.jsxs)("main",{style:{maxWidth:1100,margin:"0 auto",padding:"32px 0 0 0",display:"flex",flexDirection:"column",alignItems:"stretch"},children:[(0,j.jsx)(g.A,{title:"Institutionen & Admins \xdcbersicht"}),(0,j.jsxs)(y.Lj,{children:[(0,j.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:0,marginBottom:18},children:[(0,j.jsx)("span",{style:{fontSize:"1.25em",fontWeight:700,color:"#4CAF50",marginBottom:8},children:"Admins"}),(0,j.jsxs)(y.VI,{children:[(0,j.jsxs)(y.sw,{style:{flex:1,width:"100%"},children:[(0,j.jsx)(y.VV,{type:"text",placeholder:"Suchen...",value:o,onChange:e=>l(e.target.value),"aria-label":"Suchen"}),(0,j.jsx)(E,{})]}),(0,j.jsx)(A,{onClick:()=>c(!0),children:"+ Hinzuf\xfcgen"})]})]}),(0,j.jsx)(y.bQ,{data:n,columns:[{key:"name",label:"Name",editable:!0,filterable:!0,sortable:!0},{key:"email",label:"E-Mail",editable:!0,filterable:!0,sortable:!0},{key:"institutionName",label:"Institution",editable:!1,filterable:!0,sortable:!0},{key:"password",label:"Passwort (neu setzen)",editable:!0},{key:"id",label:"Admin-ID",editable:!1,filterable:!0,sortable:!0}],onEdit:async e=>{a(!0);try{await fetch("/api/users/".concat(e.id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e.name,email:e.email,password:e.password||void 0}),credentials:"include"}),await Q()}catch(n){r(n.message||"Fehler beim Bearbeiten.")}a(!1)},onDelete:async e=>{a(!0);try{await fetch("/api/users/".concat(e.id),{method:"DELETE",credentials:"include"}),await Q()}catch(n){r(n.message||"Fehler beim L\xf6schen.")}a(!1)},entityName:"Admin",search:o,page:v,rowsPerPage:k,onPageChange:C,onRowsPerPageChange:e=>{I(e),C(0)},totalCount:n.length,loading:i,error:s})]}),(0,j.jsxs)(b.Ay,{open:d,onClose:()=>{c(!1),S(null)},title:"Admin hinzuf\xfcgen",children:[w&&(0,j.jsx)(b.yn,{children:w}),(0,j.jsxs)("form",{onSubmit:e=>{e.preventDefault(),(async()=>{if(h.name&&h.email&&h.password&&h.institutionId){a(!0),S(null);try{const e=await fetch("/api/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:h.name,email:h.email,password:h.password,role:"ADMIN"}),credentials:"include"});if(!e.ok)throw new Error("Fehler beim Hinzuf\xfcgen.");const n=await e.json();await fetch("/api/institutions/".concat(h.institutionId,"/assign-admin"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({adminId:n.id}),credentials:"include"}),c(!1),x({name:"",email:"",password:"",institutionId:""}),await Q()}catch(e){S(e.message||"Fehler beim Hinzuf\xfcgen.")}a(!1)}else S("Name, E-Mail, Passwort und Institution sind erforderlich.")})()},children:[(0,j.jsxs)(b.zB,{children:[(0,j.jsx)(b.JU,{htmlFor:"admin-name",children:"Name"}),(0,j.jsx)(b.pd,{id:"admin-name",value:h.name,onChange:e=>x(n=>(0,u.A)((0,u.A)({},n),{},{name:e.target.value})),autoFocus:!0,required:!0})]}),(0,j.jsxs)(b.zB,{children:[(0,j.jsx)(b.JU,{htmlFor:"admin-email",children:"E-Mail"}),(0,j.jsx)(b.pd,{id:"admin-email",type:"email",value:h.email,onChange:e=>x(n=>(0,u.A)((0,u.A)({},n),{},{email:e.target.value})),required:!0})]}),(0,j.jsxs)(b.zB,{children:[(0,j.jsx)(b.JU,{htmlFor:"admin-password",children:"Passwort"}),(0,j.jsx)(b.pd,{id:"admin-password",type:"password",value:h.password,onChange:e=>x(n=>(0,u.A)((0,u.A)({},n),{},{password:e.target.value})),required:!0,autoComplete:"new-password"})]}),(0,j.jsxs)(b.zB,{children:[(0,j.jsx)(b.JU,{htmlFor:"admin-institution",children:"Institution"}),(0,j.jsxs)("select",{id:"admin-institution",value:h.institutionId,onChange:e=>x(n=>(0,u.A)((0,u.A)({},n),{},{institutionId:e.target.value})),required:!0,style:{width:"100%",padding:"10px",borderRadius:"8px",border:"1px solid #ccc"},children:[(0,j.jsx)("option",{value:"",children:"Bitte w\xe4hlen..."}),F.map(e=>(0,j.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,j.jsx)(b.yl,{type:"submit",children:"Hinzuf\xfcgen"})]})]}),(0,j.jsxs)(y.Lj,{children:[(0,j.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:0,marginBottom:18},children:[(0,j.jsx)("span",{style:{fontSize:"1.25em",fontWeight:700,color:"#4CAF50",marginBottom:8},children:"Institutionen"}),(0,j.jsxs)(y.VI,{children:[(0,j.jsxs)(y.sw,{style:{flex:1,width:"100%"},children:[(0,j.jsx)(y.VV,{type:"text",placeholder:"Suchen...",value:B,onChange:e=>L(e.target.value),"aria-label":"Suchen"}),(0,j.jsx)(E,{})]}),(0,j.jsx)(A,{onClick:()=>J(!0),children:"+ Hinzuf\xfcgen"})]})]}),(0,j.jsx)(y.bQ,{data:F,columns:[{key:"name",label:"Name",editable:!0,filterable:!0,sortable:!0},{key:"address",label:"Adresse",editable:!0,filterable:!0,sortable:!0},{key:"id",label:"Institutions-ID",editable:!1,filterable:!0,sortable:!0}],onEdit:async e=>{P(!0),q(null);try{await(0,f.M6)(e.id,{name:e.name,address:e.address}),Z()}catch(n){q(n.message||"Fehler beim Bearbeiten der Institution.")}P(!1)},onDelete:async e=>{P(!0),q(null);try{await(0,f.Dx)(e.id),Z()}catch(n){q(n.message||"Fehler beim L\xf6schen der Institution.")}P(!1)},entityName:"Institution",search:B,page:H,rowsPerPage:W,onPageChange:V,onRowsPerPageChange:e=>{_(e),V(0)},totalCount:F.length,loading:z,error:N})]}),(0,j.jsxs)(b.Ay,{open:O,onClose:()=>{J(!1),q(null)},title:"Institution hinzuf\xfcgen",children:[R&&(0,j.jsx)(b.yn,{children:R}),(0,j.jsxs)("form",{onSubmit:e=>{e.preventDefault(),(async()=>{if(U.name){P(!0),q(null);try{await(0,f.zC)({name:U.name,address:U.address}),J(!1),Z()}catch(e){q(e.message||"Fehler beim Anlegen der Institution.")}P(!1)}else q("Name ist erforderlich.")})()},children:[(0,j.jsxs)(b.zB,{children:[(0,j.jsx)(b.JU,{htmlFor:"institution-name",children:"Name"}),(0,j.jsx)(b.pd,{id:"institution-name",value:U.name,onChange:e=>M(n=>(0,u.A)((0,u.A)({},n),{},{name:e.target.value})),autoFocus:!0,required:!0})]}),(0,j.jsxs)(b.zB,{children:[(0,j.jsx)(b.JU,{htmlFor:"institution-address",children:"Adresse"}),(0,j.jsx)(b.pd,{id:"institution-address",value:U.address,onChange:e=>M(n=>(0,u.A)((0,u.A)({},n),{},{address:e.target.value})),required:!0})]}),(0,j.jsx)(b.yl,{type:"submit",children:"Hinzuf\xfcgen"})]})]})]})})},2045:(e,n,t)=>{t.d(n,{$r:()=>h,Bp:()=>u,Bx:()=>r,Dx:()=>b,M6:()=>x,O6:()=>f,UR:()=>m,Uh:()=>o,Zr:()=>p,cM:()=>g,gv:()=>s,p2:()=>y,u_:()=>c,yS:()=>w,zC:()=>l});var i=t(9379);const a="/api";async function s(){const e=await fetch("".concat(a,"/users?role=ADMIN"),{credentials:"include",headers:{"Content-Type":"application/json"}});if(!e.ok)throw new Error("Fehler beim Laden der Institutionen (Admins)");return e.json()}async function r(){const e=await fetch("".concat(a,"/users?role=EDUCATOR"),{credentials:"include",headers:{"Content-Type":"application/json"}});if(!e.ok)throw new Error("Fehler beim Laden der Erzieher");return e.json()}async function o(){const e=await fetch("".concat(a,"/users?role=PARENT"),{credentials:"include",headers:{"Content-Type":"application/json"}});if(!e.ok)throw new Error("Fehler beim Laden der Eltern");return e.json()}async function l(e){const n=await fetch("".concat(a,"/institutionen"),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!n.ok)throw new Error("Fehler beim Anlegen der Institution");return n.json()}async function d(){const e=await fetch("".concat(a,"/stats"),{credentials:"include"});if(!e.ok)throw new Error("Fehler beim Laden der Statistiken");return e.json()}const c=d,u=d;async function h(e){const n=await fetch("".concat(a,"/users"),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify((0,i.A)((0,i.A)({},e),{},{role:"EDUCATOR"}))});if(!n.ok)throw new Error("Fehler beim Anlegen des Erziehers");return n.json()}async function m(e,n){const t=await fetch("".concat(a,"/users/").concat(e),{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!t.ok)throw new Error("Fehler beim Bearbeiten des Erziehers");return t.json()}async function p(e){const n=await fetch("".concat(a,"/users/").concat(e),{method:"DELETE",credentials:"include"});if(!n.ok)throw new Error("Fehler beim L\xf6schen des Erziehers");return n.json()}async function f(e){const n=await fetch("".concat(a,"/users"),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify((0,i.A)((0,i.A)({},e),{},{role:"PARENT"}))});if(!n.ok)throw new Error("Fehler beim Anlegen des Elternteils");return n.json()}async function y(e,n){const t=await fetch("".concat(a,"/users/").concat(e),{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!t.ok)throw new Error("Fehler beim Bearbeiten des Elternteils");return t.json()}async function g(e){const n=await fetch("".concat(a,"/users/").concat(e),{method:"DELETE",credentials:"include"});if(!n.ok)throw new Error("Fehler beim L\xf6schen des Elternteils");return n.json()}async function x(e,n){const t=await fetch("".concat(a,"/institutionen/").concat(e),{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!t.ok)throw new Error("Fehler beim Bearbeiten der Institution");return t.json()}async function b(e){const n=await fetch("".concat(a,"/institutionen/").concat(e),{method:"DELETE",credentials:"include"});if(!n.ok)throw new Error("Fehler beim L\xf6schen der Institution");return n.json()}async function w(){const e=await fetch("".concat(a,"/institutionen"),{credentials:"include",headers:{"Content-Type":"application/json"}});if(!e.ok)throw new Error("Fehler beim Laden der Institutionen");return e.json()}},3411:(e,n,t)=>{t.d(n,{A:()=>d});var i,a=t(7528),s=(t(5043),t(2774)),r=t(5464),o=t(579);const l=r.Ay.div(i||(i=(0,a.A)(["\n  position: absolute;\n  left: 18px;\n  top: 50%;\n  transform: translateY(-50%);\n  color: #757575;\n  pointer-events: none;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n"]))),d=()=>(0,o.jsx)(l,{children:(0,o.jsx)(s.KSO,{})})}}]);
//# sourceMappingURL=284.f2a18d94.chunk.js.map